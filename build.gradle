
apply plugin: 'java'
apply plugin: 'eclipse'

sourceCompatibility = JavaVersion.VERSION_1_8
targetCompatibility = JavaVersion.VERSION_1_8

compileJava.options.encoding = "UTF-8"
compileTestJava.options.encoding = "UTF-8"


repositories {
    mavenCentral()
}

dependencies {
    testImplementation 'io.cucumber:cucumber-junit:5.6.0'
    testImplementation 'io.cucumber:cucumber-java:5.6.0'
    implementation 'junit:junit:4.12'
    implementation 'junit:junit:4.13'
    implementation 'org.apache.httpcomponents:httpclient:4.5.12'
    implementation 'org.apache.httpcomponents:fluent-hc:4.5.12'
}

configurations {
    cucumberRuntime {
        extendsFrom testImplementation
    }
}

task cucumber() {
    dependsOn assemble, compileTestJava
    doLast {
        javaexec {
            systemProperty "javax.net.ssl.trustStore", "U:\\opt\\rsv\\pki\\test\\int_org\\ca-cert-jks\\root-Skatteverkets_Interna_ORG_CAs_TEST-crt.jks"
            main = "io.cucumber.core.cli.Main"
            classpath = configurations.cucumberRuntime + sourceSets.main.output + sourceSets.test.output
            args = ['--str t', '--plugin', 'pretty', '--glue', 'cucumber', 'src/test/resources']
        }
    }
}